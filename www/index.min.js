$(function(){Date.prototype.toYMD=function(){let e,a,t;e=String(this.getFullYear()),1===(a=String(this.getMonth()+1)).length&&(a="0"+a);1===(t=String(this.getDate())).length&&(t="0"+t);return e+"-"+a+"-"+t};let e=(new Date).toUTCString();$("#title").html("COVID-19 Statistics as of "+e),window.setInterval(function(){e=(new Date).toUTCString(),$("#title").html("COVID-19 Statistics as of "+e)},1e3);const a=document.getElementById("worldwide-chart").getContext("2d"),t=document.getElementById("outlook-chart").getContext("2d"),s=new Chart(a,{type:"line",data:d(null),options:{responsive:!0,maintainAspectRatio:!1,scales:{xAxes:[{gridLines:{display:!1},ticks:{autoSkip:!0,maxTicksLimit:20}}],yAxes:[{ticks:{beginAtZero:!0}}]}}}),o=new Chart(t,{type:"line",data:{datasets:[]},options:{responsive:!0,maintainAspectRatio:!1,legend:{display:!1},scales:{xAxes:[{type:"linear",display:!1,gridLines:{display:!1}}],yAxes:[{gridLines:{display:!1}}]}}});function d(e){let a;return a=e?{data:{labels:e.map(e=>new Date(e.created).toYMD()),datasets:[{label:"Total Cases",data:e.map(e=>e.cases),backgroundColor:["rgba(255,177,0,0.41)"],borderColor:["rgb(255,249,146)"],borderWidth:1},{label:"Total Deaths",data:e.map(e=>e.deaths),backgroundColor:["rgba(255,24,1,0.4)"],borderColor:["rgb(255,91,82)"],borderWidth:1},{label:"Total Recovered",data:e.map(e=>e.recovered),backgroundColor:["rgba(57,255,0,0.4)"],borderColor:["rgb(141,255,102)"],borderWidth:1}]}}:{data:{labels:[],datasets:[]}}}$("#countries_table").DataTable({ajax:{url:"/countries/today",dataSrc:""},order:[[1,"desc"]],columns:[{data:"country"},{data:"cases"},{data:"todayCases"},{data:"deaths"},{data:"todayDeaths"},{data:"recovered"},{data:"active"},{data:"critical"},{data:"casesPerOneMillion"}]}),$.ajax({url:"/worldwide/today",success:function(e){const a=e.cases-(e.deaths+e.recovered);$("#today-cases").html(e.cases),$("#today-active").html(a),$("#today-deaths").html(e.deaths),$("#today-recovered").html(e.recovered),$("#today-active-percentage").html("("+(a/e.cases*100).toFixed(1)+"%)"),$("#today-deaths-percentage").html("("+(e.deaths/e.cases*100).toFixed(1)+"%)"),$("#today-recovered-percentage").html("("+(e.recovered/e.cases*100).toFixed(1)+"%)")}}),$.ajax({url:"/worldwide",success:function(e){const a=d(e);s.data.labels.push(...a.data.labels),s.data.datasets.push(...a.data.datasets),s.update()}}),$.ajax({url:"/worldwide/predictions",success:function(e){!function(e){$("#today-actual-cases").html(e.actualCasesValue),$("#today-actual-cases-percentage").html("(+"+e.actualCasesGrowth+"%)"),e.actualCasesValue>e.expectedCases?($("#today-actual-cases").addClass("negative"),$("#today-actual-cases-percentage").addClass("negative")):($("#today-actual-cases").addClass("positive"),$("#today-actual-cases-percentage").addClass("positive"));e.expectedCasesGrowth>0?($("#today-expected-cases").html(e.expectedCases),e.expectedCasesGrowth>0&&e.expectedCasesGrowth<5?($("#today-expected-cases").addClass("neutral"),$("#today-expected-cases-percentage").addClass("neutral")):e.expectedCasesGrowth>=5&&($("#today-expected-cases").addClass("negative"),$("#today-expected-cases-percentage").addClass("negative")),$("#today-expected-cases-percentage").html("(+"+e.expectedCasesGrowth+"%)")):($("#today-expected-cases").html(e.lastCasesValue),$("#today-expected-cases-percentage").html("(0%)"),$("#today-expected-cases").addClass("positive"),$("#today-expected-cases-percentage").addClass("positive"));e.outlookValue>.9&&e.outlookValue<1.1?($("#today-outlook").html("NEUTRAL"),$("#today-outlook").addClass("neutral"),$("#today-outlook-value").addClass("neutral")):e.outlookValue>=1.1?($("#today-outlook").html("NEGATIVE"),$("#today-outlook").addClass("negative"),$("#today-outlook-value").addClass("negative")):e.outlookValue<=.9&&($("#today-outlook").html("POSITIVE"),$("#today-outlook").addClass("positive"),$("#today-outlook-value").addClass("positive"));$("#today-outlook-value").html("("+(e.outlookValue>=0?"+":"")+e.outlookValue+")"),o.data.datasets.push({label:"Outlook",data:e.outLookArray,fill:!1,borderColor:["rgb(82,200,255)"],borderWidth:2}),o.update()}(e)}})});